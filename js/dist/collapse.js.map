{"version":3,"file":"collapse.js","sources":["../src/collapse.js"],"sourcesContent":["import Data from './dom/data'\nimport EventHandler from './dom/eventHandler'\nimport Manipulator from './dom/manipulator'\nimport SelectorEngine from './dom/selectorEngine'\nimport Util from './util'\n\n/**\n * --------------------------------------------------------------------------\n * Bootstrap (v4.1.3): collapse.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME                = 'collapse'\nconst VERSION             = '4.1.3'\nconst DATA_KEY            = 'bs.collapse'\nconst EVENT_KEY           = `.${DATA_KEY}`\nconst DATA_API_KEY        = '.data-api'\n\nconst Default = {\n  toggle : true,\n  parent : ''\n}\n\nconst DefaultType = {\n  toggle : 'boolean',\n  parent : '(string|element)'\n}\n\nconst Event = {\n  SHOW           : `show${EVENT_KEY}`,\n  SHOWN          : `shown${EVENT_KEY}`,\n  HIDE           : `hide${EVENT_KEY}`,\n  HIDDEN         : `hidden${EVENT_KEY}`,\n  CLICK_DATA_API : `click${EVENT_KEY}${DATA_API_KEY}`\n}\n\nconst ClassName = {\n  SHOW       : 'show',\n  COLLAPSE   : 'collapse',\n  COLLAPSING : 'collapsing',\n  COLLAPSED  : 'collapsed'\n}\n\nconst Dimension = {\n  WIDTH  : 'width',\n  HEIGHT : 'height'\n}\n\nconst Selector = {\n  ACTIVES     : '.show, .collapsing',\n  DATA_TOGGLE : '[data-toggle=\"collapse\"]'\n}\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Collapse {\n  constructor(element, config) {\n    this._isTransitioning = false\n    this._element         = element\n    this._config          = this._getConfig(config)\n    this._triggerArray    = Util.makeArray(SelectorEngine.find(\n      `[data-toggle=\"collapse\"][href=\"#${element.id}\"],` +\n      `[data-toggle=\"collapse\"][data-target=\"#${element.id}\"]`\n    ))\n\n    const toggleList = SelectorEngine.find(Selector.DATA_TOGGLE)\n    for (let i = 0, len = toggleList.length; i < len; i++) {\n      const elem = toggleList[i]\n      const selector = Util.getSelectorFromElement(elem)\n      const filterElement = [].slice.call(document.querySelectorAll(selector))\n        .filter((foundElem) => foundElem === element)\n\n      if (selector !== null && filterElement.length) {\n        this._selector = selector\n        this._triggerArray.push(elem)\n      }\n    }\n\n    this._parent = this._config.parent ? this._getParent() : null\n\n    if (!this._config.parent) {\n      this._addAriaAndCollapsedClass(this._element, this._triggerArray)\n    }\n\n    if (this._config.toggle) {\n      this.toggle()\n    }\n\n    Data.setData(element, DATA_KEY, this)\n  }\n\n  // Getters\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  static get Default() {\n    return Default\n  }\n\n  // Public\n\n  toggle() {\n    if (this._element.classList.contains(ClassName.SHOW)) {\n      this.hide()\n    } else {\n      this.show()\n    }\n  }\n\n  show() {\n    if (this._isTransitioning ||\n      this._element.classList.contains(ClassName.SHOW)) {\n      return\n    }\n\n    let actives\n    let activesData\n\n    if (this._parent) {\n      actives = Util.makeArray(SelectorEngine.find(Selector.ACTIVES, this._parent))\n        .filter((elem) => elem.getAttribute('data-parent') === this._config.parent)\n\n      if (!actives.length) {\n        actives = null\n      }\n    }\n\n    const container = SelectorEngine.findOne(this._selector)\n    if (actives) {\n      const tempActiveData = actives.filter((elem) => container !== elem)\n      activesData = tempActiveData[0] ? Data.getData(tempActiveData[0], DATA_KEY) : null\n\n      if (activesData && activesData._isTransitioning) {\n        return\n      }\n    }\n\n    const startEvent = EventHandler.trigger(this._element, Event.SHOW)\n    if (startEvent.defaultPrevented) {\n      return\n    }\n\n    if (actives) {\n      actives.forEach((elemActive) => {\n        if (container !== elemActive) {\n          Collapse._collapseInterface(elemActive, 'hide')\n        }\n\n        if (!activesData) {\n          Data.setData(elemActive, DATA_KEY, null)\n        }\n      })\n    }\n\n    const dimension = this._getDimension()\n\n    this._element.classList.remove(ClassName.COLLAPSE)\n    this._element.classList.add(ClassName.COLLAPSING)\n\n    this._element.style[dimension] = 0\n\n    if (this._triggerArray.length) {\n      this._triggerArray.forEach((element) => {\n        element.classList.remove(ClassName.COLLAPSED)\n        element.setAttribute('aria-expanded', true)\n      })\n    }\n\n    this.setTransitioning(true)\n\n    const complete = () => {\n      this._element.classList.remove(ClassName.COLLAPSING)\n      this._element.classList.add(ClassName.COLLAPSE)\n      this._element.classList.add(ClassName.SHOW)\n\n      this._element.style[dimension] = ''\n\n      this.setTransitioning(false)\n\n      EventHandler.trigger(this._element, Event.SHOWN)\n    }\n\n    const capitalizedDimension = dimension[0].toUpperCase() + dimension.slice(1)\n    const scrollSize = `scroll${capitalizedDimension}`\n    const transitionDuration = Util.getTransitionDurationFromElement(this._element)\n\n    EventHandler.one(this._element, Util.TRANSITION_END, complete)\n\n    Util.emulateTransitionEnd(this._element, transitionDuration)\n    this._element.style[dimension] = `${this._element[scrollSize]}px`\n  }\n\n  hide() {\n    if (this._isTransitioning ||\n      !this._element.classList.contains(ClassName.SHOW)) {\n      return\n    }\n\n    const startEvent = EventHandler.trigger(this._element, Event.HIDE)\n    if (startEvent.defaultPrevented) {\n      return\n    }\n\n    const dimension = this._getDimension()\n\n    this._element.style[dimension] = `${this._element.getBoundingClientRect()[dimension]}px`\n\n    Util.reflow(this._element)\n\n    this._element.classList.add(ClassName.COLLAPSING)\n    this._element.classList.remove(ClassName.COLLAPSE)\n    this._element.classList.remove(ClassName.SHOW)\n\n    const triggerArrayLength = this._triggerArray.length\n    if (triggerArrayLength > 0) {\n      for (let i = 0; i < triggerArrayLength; i++) {\n        const trigger = this._triggerArray[i]\n        const selector = Util.getSelectorFromElement(trigger)\n        if (selector !== null) {\n          const elem = SelectorEngine.findOne(selector)\n          if (!elem.classList.contains(ClassName.SHOW)) {\n            trigger.classList.add(ClassName.COLLAPSED)\n            trigger.setAttribute('aria-expanded', false)\n          }\n        }\n      }\n    }\n\n    this.setTransitioning(true)\n\n    const complete = () => {\n      this.setTransitioning(false)\n      this._element.classList.remove(ClassName.COLLAPSING)\n      this._element.classList.add(ClassName.COLLAPSE)\n      EventHandler.trigger(this._element, Event.HIDDEN)\n    }\n\n    this._element.style[dimension] = ''\n    const transitionDuration = Util.getTransitionDurationFromElement(this._element)\n\n    EventHandler.one(this._element, Util.TRANSITION_END, complete)\n    Util.emulateTransitionEnd(this._element, transitionDuration)\n  }\n\n  setTransitioning(isTransitioning) {\n    this._isTransitioning = isTransitioning\n  }\n\n  dispose() {\n    Data.removeData(this._element, DATA_KEY)\n\n    this._config          = null\n    this._parent          = null\n    this._element         = null\n    this._triggerArray    = null\n    this._isTransitioning = null\n  }\n\n  // Private\n\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...config\n    }\n    config.toggle = Boolean(config.toggle) // Coerce string values\n    Util.typeCheckConfig(NAME, config, DefaultType)\n    return config\n  }\n\n  _getDimension() {\n    const hasWidth = this._element.classList.contains(Dimension.WIDTH)\n    return hasWidth ? Dimension.WIDTH : Dimension.HEIGHT\n  }\n\n  _getParent() {\n    let parent = null\n    if (Util.isElement(this._config.parent)) {\n      parent = this._config.parent\n\n      // it's a jQuery object\n      if (typeof this._config.parent.jquery !== 'undefined' || typeof this._config.parent[0] !== 'undefined') {\n        parent = this._config.parent[0]\n      }\n    } else {\n      parent = SelectorEngine.findOne(this._config.parent)\n    }\n\n    const selector =\n      `[data-toggle=\"collapse\"][data-parent=\"${this._config.parent}\"]`\n\n    const elements = Util.makeArray(SelectorEngine.find(selector, parent))\n    elements.forEach((element) =>\n      this._addAriaAndCollapsedClass(\n        Collapse._getTargetFromElement(element),\n        [element]\n      ))\n\n    return parent\n  }\n\n  _addAriaAndCollapsedClass(element, triggerArray) {\n    if (element) {\n      const isOpen = element.classList.contains(ClassName.SHOW)\n\n      if (triggerArray.length > 0) {\n        triggerArray.forEach((elem) => {\n          if (!isOpen) {\n            elem.classList.add(ClassName.COLLAPSED)\n          } else {\n            elem.classList.remove(ClassName.COLLAPSED)\n          }\n          elem.setAttribute('aria-expanded', isOpen)\n        })\n      }\n    }\n  }\n\n  // Static\n\n  static _getTargetFromElement(element) {\n    const selector = Util.getSelectorFromElement(element)\n    return selector ? SelectorEngine.findOne(selector) : null\n  }\n\n  static _collapseInterface(element, config) {\n    let data      = Data.getData(element, DATA_KEY)\n    const _config = {\n      ...Default,\n      ...Manipulator.getDataAttributes(element),\n      ...typeof config === 'object' && config ? config : {}\n    }\n\n    if (!data && _config.toggle && /show|hide/.test(config)) {\n      _config.toggle = false\n    }\n\n    if (!data) {\n      data = new Collapse(element, _config)\n    }\n\n    if (typeof config === 'string') {\n      if (typeof data[config] === 'undefined') {\n        throw new Error(`No method named \"${config}\"`)\n      }\n      data[config]()\n    }\n  }\n\n  static _jQueryInterface(config) {\n    return this.each(function () {\n      Collapse._collapseInterface(this, config)\n    })\n  }\n\n  static _getInstance(element) {\n    return Data.getData(element, DATA_KEY)\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nEventHandler.on(document, Event.CLICK_DATA_API, Selector.DATA_TOGGLE, function (event) {\n  // preventDefault only for <a> elements (which change the URL) not inside the collapsible element\n  if (event.target.tagName === 'A') {\n    event.preventDefault()\n  }\n\n  const triggerData      = Manipulator.getDataAttributes(this)\n  const selector         = Util.getSelectorFromElement(this)\n  const selectorElements = Util.makeArray(SelectorEngine.find(selector))\n\n  selectorElements.forEach((element) => {\n    const data = Data.getData(element, DATA_KEY)\n\n    let config\n    if (data) {\n      // update parent attribute\n      if (data._parent === null && typeof triggerData.parent === 'string') {\n        data._config.parent = triggerData.parent\n        data._parent = data._getParent()\n      }\n\n      config = 'toggle'\n    } else {\n      config = triggerData\n    }\n\n    Collapse._collapseInterface(element, config)\n  })\n})\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n * add .collapse to jQuery only if jQuery is present\n */\n\nconst $ = Util.jQuery\nif (typeof $ !== 'undefined') {\n  const JQUERY_NO_CONFLICT  = $.fn[NAME]\n  $.fn[NAME]                = Collapse._jQueryInterface\n  $.fn[NAME].Constructor    = Collapse\n  $.fn[NAME].noConflict     = () => {\n    $.fn[NAME] = JQUERY_NO_CONFLICT\n    return Collapse._jQueryInterface\n  }\n}\n\nexport default Collapse\n"],"names":["NAME","VERSION","DATA_KEY","EVENT_KEY","DATA_API_KEY","Default","toggle","parent","DefaultType","Event","SHOW","SHOWN","HIDE","HIDDEN","CLICK_DATA_API","ClassName","COLLAPSE","COLLAPSING","COLLAPSED","Dimension","WIDTH","HEIGHT","Selector","ACTIVES","DATA_TOGGLE","Collapse","element","config","_isTransitioning","_element","_config","_getConfig","_triggerArray","Util","makeArray","SelectorEngine","find","id","toggleList","i","len","length","elem","selector","getSelectorFromElement","filterElement","slice","call","document","querySelectorAll","filter","foundElem","_selector","push","_parent","_getParent","_addAriaAndCollapsedClass","Data","setData","classList","contains","hide","show","actives","activesData","getAttribute","container","findOne","tempActiveData","getData","startEvent","EventHandler","trigger","defaultPrevented","forEach","elemActive","_collapseInterface","dimension","_getDimension","remove","add","style","setAttribute","setTransitioning","complete","capitalizedDimension","toUpperCase","scrollSize","transitionDuration","getTransitionDurationFromElement","one","TRANSITION_END","emulateTransitionEnd","getBoundingClientRect","reflow","triggerArrayLength","isTransitioning","dispose","removeData","Boolean","typeCheckConfig","hasWidth","isElement","jquery","elements","_getTargetFromElement","triggerArray","isOpen","data","Manipulator","getDataAttributes","test","Error","_jQueryInterface","each","_getInstance","on","event","target","tagName","preventDefault","triggerData","selectorElements","$","jQuery","JQUERY_NO_CONFLICT","fn","Constructor","noConflict"],"mappings":"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"}